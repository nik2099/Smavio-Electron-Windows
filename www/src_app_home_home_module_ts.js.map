{"version":3,"sources":["./src/app/home/home-routing.module.ts","./src/app/home/home.module.ts","./src/app/home/home.page.ts","./src/app/home/home.page.scss","./src/app/home/home.page.html"],"names":[],"mappings":"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","file":"src_app_home_home_module_ts.js","sourcesContent":["import { NgModule } from '@angular/core';\r\nimport { Routes, RouterModule } from '@angular/router';\r\n\r\nimport { HomePage } from './home.page';\r\n\r\nconst routes: Routes = [\r\n  {\r\n    path: '',\r\n    component: HomePage\r\n  }\r\n];\r\n\r\n@NgModule({\r\n  imports: [RouterModule.forChild(routes)],\r\n  exports: [RouterModule],\r\n})\r\nexport class HomePageRoutingModule {}\r\n","import { NgModule } from '@angular/core';\r\nimport { CommonModule } from '@angular/common';\r\nimport { FormsModule } from '@angular/forms';\r\n\r\nimport { IonicModule } from '@ionic/angular';\r\n\r\nimport { HomePageRoutingModule } from './home-routing.module';\r\n\r\nimport { HomePage } from './home.page';\r\n\r\n@NgModule({\r\n  imports: [\r\n    CommonModule,\r\n    FormsModule,\r\n    IonicModule,\r\n    HomePageRoutingModule\r\n  ],\r\n  declarations: [HomePage]\r\n})\r\nexport class HomePageModule {}\r\n","import { Component, OnInit } from '@angular/core';\r\nimport { ModalController,AlertController } from '@ionic/angular';\r\nimport { LoginPage } from '../login/login.page';\r\nimport { TokenStorageService } from '../_services/token-storage.service';\r\nimport { AppComponent } from '../app.component';\r\nimport { AuthService } from '../_services/auth.service';\r\nimport { DomSanitizer, SafeResourceUrl} from '@angular/platform-browser';\r\nimport { NotificationService } from '../_services/notification.service';\r\nimport { Router } from '@angular/router';\r\nimport { MenuController, } from '@ionic/angular';\r\nimport { interval } from 'rxjs';\r\nimport { LoadingController } from '@ionic/angular';\r\n\r\n@Component({\r\n  selector: 'app-home',\r\n  templateUrl: './home.page.html',\r\n  styleUrls: ['./home.page.scss'],\r\n})\r\nexport class HomePage implements OnInit {\r\n\r\n  isLoggedIn = false;\r\n  campaignId:any;\r\n  campaignUrl : any;\r\n  campaignName: any;\r\n  user : any;\r\n  isLoading = false;\r\n\r\n\r\n  constructor(\r\n    public modalController: ModalController,\r\n    private tokenStorage: TokenStorageService,\r\n    private appComponent: AppComponent,\r\n    private router: Router,\r\n    private authService: AuthService,\r\n    private sanitizer: DomSanitizer,\r\n    private menu: MenuController,\r\n    public alertController: AlertController,\r\n    private notificationService: NotificationService,\r\n    public loadingController: LoadingController\r\n    ) {\r\n\r\n   \r\n    }\r\n\r\n\r\n     loaderStart() {\r\n\t    this.isLoading = true;\r\n\t    return this.loadingController.create({\r\n\t    //   message: this.wait\r\n\t    }).then(a => {\r\n\t      a.present().then(() => {\r\n\t        console.log('presented');\r\n\t        if (!this.isLoading) {\r\n\t          a.dismiss().then(() => console.log('abort presenting'));\r\n\t        }\r\n\t      });\r\n\t    });\r\n  }\r\n\r\n  loaderStop() {\r\n    this.isLoading = false;\r\n    return this.loadingController.dismiss().then(() => console.log('dismissed'));\r\n  }\r\n    \r\n\r\n  checkStatus(){\r\n    \r\n    this.appComponent.testNetwork().then(\r\n      networkConnected => {\r\n        if(networkConnected){\r\n          this.appComponent.testHost().then(\r\n            isHostUp => {\r\n              if(isHostUp){\r\n                this.appComponent.validateToken().then(\r\n                  isTokenValid => {\r\n                    if(isTokenValid){\r\n                      this.appComponent.onScreenDoubleClick();\r\n                      this.isLoggedIn = true;\r\n                      this.getCampaign();\r\n                    } else {\r\n                      this.isLoggedIn = false;\r\n                      this.tokenStorage.signOut().then(() => {\r\n                        this.router.navigate(['/login']);\r\n                      });\r\n                    }\r\n                  }\r\n                );\r\n              } else {\r\n                this.isLoggedIn = false;\r\n              }\r\n            }\r\n          );\r\n        }\r\n      }\r\n    );\r\n\r\n\r\n  }\r\n  \r\n \r\n\r\n\r\n  checkUserStaus(){\r\n    this.authService.checkUser().then(\r\n      response => {\r\n       this.user = response.data.user;\r\n      \r\n        this.tokenStorage.getToken().then(\r\n          token => {\r\n            if(token == null){\r\n              this.authService.logout(token).then(\r\n                data => {\r\n                  this.tokenStorage.signOut().then(() => {\r\n                    this.router.navigate(['/login']);\r\n                  });\r\n                }\r\n              );\r\n            }\r\n          }\r\n        );\r\n\r\n      },\r\n      error =>{  \r\n\r\n       }\r\n    );\r\n  }\r\n\r\n\r\n  getCampaign(){\r\n\r\n    this.authService.getAssignCompaign().then(\r\n      response => {\r\n        console.log(response);\r\n          if(response.status == 200){\r\n              if(response.data.success == true){\r\n                  // if(response.data.update_available != true){\r\n                      this.tokenStorage.saveCampaignId(response.data.campaign_id).then(() => {\r\n                        this.campaignId  = response.data.campaign_id;\r\n                        this.campaignName  = response.data.campaign_name;\r\n                        \r\n                        const campaign_url = 'https://service-backend.smavio.de/campaign/'+this.campaignId+'/preview'\r\n                        this.campaignUrl =this.sanitizer.bypassSecurityTrustResourceUrl(campaign_url)\r\n                      });\r\n                  // }\r\n\r\n                //   else{\r\n                //     this.notificationService.compaignUpdateAlert();\r\n                // }\r\n                \r\n              }else{\r\n                this.campaignAlert(response);\r\n              }\r\n          }else{\r\n            if(response.status == 401){ \r\n              this.tokenStorage.signOut().then(() => {\r\n                console.log('logout');\r\n                this.router.navigate(['/login']);\r\n              });\r\n            }\r\n          }    \r\n        \r\n      },\r\n      error =>{\r\n        \r\n      }\r\n    );\r\n  }\r\n\r\n  \r\n\r\n  async campaignAlert(response) {\r\n    \r\n    let resolveFunction: (confirm: boolean) => void;\r\n    const promise = new Promise<boolean>(resolve => {\r\n      resolveFunction = resolve;\r\n    });\r\n\r\n    const alert = await this.alertController.create({\r\n      cssClass: 'custom-ion-alert campaign-alert',\r\n      header: 'Alert',\r\n      backdropDismiss: false,\r\n      message: 'Campain not asign you,please contact to admin',\r\n      buttons: [\r\n        {\r\n          text: 'Reload Page',\r\n          cssClass: 'custom-ion-dark-btn',\r\n          handler: () => {\r\n            this.getCampaign();\r\n            alert.dismiss();\r\n          }\r\n        }\r\n      ]\r\n    });\r\n\r\n    await alert.present();\r\n  }\r\n\r\n  // var iframe = document.getElementById('campaignFrame');\r\n  // iframe.contentWindow.body.addEventListener('mouseup', Handler);\r\n\r\n  iframeLoad(event: any){\r\n    event.target.contentWindow.addEventListener('dblclick', (event) => {\r\n      const targetIdNode = event.target.body;\r\n     \r\n      console.log(event.target.attributes.id.nodeValue)\r\n      if(targetIdNode !== undefined){\r\n        const targetId = event.target.attributes.id.nodeValue;\r\n        if(targetId === 'home-container'){\r\n          this.appComponent.openMenu();\r\n        }\r\n      }\r\n      \r\n    });\r\n  }\r\n\r\n  \r\n\r\n  ngOnInit() {\r\n    this.checkStatus();\r\n    this.checkUserStaus();\r\n    \r\n  }\r\n\r\n  ionVIewWillEnter(){\r\n    this.checkStatus();\r\n  }\r\n\r\n\r\n\r\n}\r\n","export default \"ion-content div.scroll {\\n  height: 90%;\\n}\\n\\n.templateWebPage {\\n  width: 100%;\\n  height: 100%;\\n  background-color: transparent;\\n  padding: 0px;\\n  border: none;\\n}\\n\\nion-toolbar {\\n  --color:#000;\\n  --background: #fff;\\n}\\n/*# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImhvbWUucGFnZS5zY3NzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBO0VBQ0UsV0FBQTtBQUNGOztBQUNBO0VBQ0UsV0FBQTtFQUNBLFlBQUE7RUFDQSw2QkFBQTtFQUNBLFlBQUE7RUFDQSxZQUFBO0FBRUY7O0FBQUE7RUFDRSxZQUFBO0VBQ0Esa0JBQUE7QUFHRiIsImZpbGUiOiJob21lLnBhZ2Uuc2NzcyIsInNvdXJjZXNDb250ZW50IjpbImlvbi1jb250ZW50IGRpdi5zY3JvbGx7XHJcbiAgaGVpZ2h0OiA5MCU7XHJcbn1cclxuLnRlbXBsYXRlV2ViUGFnZXtcclxuICB3aWR0aDogMTAwJTtcclxuICBoZWlnaHQ6IDEwMCU7XHJcbiAgYmFja2dyb3VuZC1jb2xvcjogdHJhbnNwYXJlbnQ7XHJcbiAgcGFkZGluZzogMHB4O1xyXG4gIGJvcmRlcjogbm9uZTtcclxufVxyXG5pb24tdG9vbGJhcntcclxuICAtLWNvbG9yOiMwMDA7XHJcbiAgLS1iYWNrZ3JvdW5kOiAjZmZmO1xyXG59Il19 */\";","export default \"<ion-header [translucent]=\\\"true\\\" *ngIf=\\\"isLoggedIn\\\">\\r\\n  <ion-toolbar class=\\\"main-header\\\">\\r\\n      <ion-buttons slot=\\\"start\\\" fill=\\\"outline\\\">\\r\\n          <ion-menu-button autoHide=\\\"true\\\" class=\\\"m-btn\\\" *ngIf=\\\"isLoggedIn\\\"></ion-menu-button>\\r\\n      </ion-buttons>\\r\\n    <ion-title size=\\\"small\\\">{{campaignName}}</ion-title>\\r\\n  </ion-toolbar>\\r\\n</ion-header>\\r\\n\\r\\n<ion-content id=\\\"home-container\\\" [fullscreen]=\\\"true\\\">\\r\\n\\r\\n  <iframe class='templateWebPage'  id=\\\"frm\\\" name=\\\"eventsPage\\\" [src]=\\\"campaignUrl\\\" allowfullscreen (load)=\\\"iframeLoad($event)\\\" *ngIf=\\\"isLoggedIn\\\">\\r\\n  </iframe>\\r\\n\\r\\n</ion-content>\\r\\n\";"],"sourceRoot":"webpack:///"}